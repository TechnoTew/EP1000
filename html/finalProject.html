<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Project</title>

    <link rel="stylesheet" href="/EP1000/css/main.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

</head>

<body>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script>
        // load nav bar
        $(function () {
            $("div#nav").load("/EP1000/html/navbar.html");
            $("div#footer").load("/EP1000/html/footer.html");
        });
    </script>

    <div id="nav"></div>

    <div id="main">
        <h4>Final Project</h4>

        <br>

        <h5>Sections</h5>
        <ul>
            <li><a href="#whatDoesItDo">What does it do?</a></li>
            <li><a href="#features">What are its features</a></li>
            <li><a href="#build">How will I build it?</a></li>
            <li><a href="#billOfMaterials">Bill of materials</a></li>
            <li><a href="#ideation">Ideation</a></li>
            <li><a href="#3dModeling">3D Modeling</a></li>
            <li><a href="#3dPrint">3D Printing</a></li>
            <li><a href="#laserCutting">Laser Cutting</a></li>
            <li><a href="#electronics">Electronics</a></li>
            <li><a href="#assembly">Assembly</a></li>
            <li><a href="#code">Code</a></li>
            <li><a href="#showcase">Showcase</a></li>
            <li><a href="#resources">Resources</a></li>
            <li><a href="#references">References</a></li>
        </ul>

        <div class="box">
            <h5 id="whatDoesItDo">What does it do?</h5>

            <p>The macropad acts a HID (Hardware Input Device) to a computer. It can open aplpications or execute
                multiple keystrokes at the touch of a single button, while being fully customizable.</p>
        </div>

        <br>

        <div class="box">
            <h5 id="features">Features</h5>

            <ul>
                <li>12 assignable Outemu mechanical switches for 12 custom functions, including but not limited to
                    <ul>
                        <li>Discord control (muting, deafening, screen sharing)</li>
                        <li>Music control (pause/play, skip, restart track)</li>
                        <li>Misc features (project button, Nvidia shadowplay)</li>
                    </ul>
                </li>

                <li>Rotary Encoder for Volume Control, switching between macropad layers</li>
            </ul>
        </div>

        <br>

        <div class="box">
            <h5 id="build" style="margin-bottom: 1rem;">Build</h5>

            <table class="table table-bordered">
                <tbody>
                    <tr>
                        <th>CAD Design, Graphics</th>
                        <td>Macropad Housing, Switch Plate</td>
                    </tr>

                    <tr>
                        <th>Laser cutting</th>
                        <td>Switch Plate (to attach the mechanical switches)</td>
                    </tr>

                    <tr>
                        <th>3D Printing</th>
                        <td>Macropad Housing</td>
                    </tr>

                    <tr>
                        <th>Micro-controller</th>
                        <td>Raspberry Pi Pico running CircuitPython (HID input interface)</td>
                    </tr>

                    <tr>
                        <th>Input Devices</th>
                        <td>Outemu Brown mechanical switches</td>
                    </tr>

                    <tr>
                        <th>Output Devices</th>
                        <td>Neopixel WS2812 LEDs (lighting), Raspberry Pi Pico (Keyboard output), SH1106/ SSD1306 OLED
                            Panel </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <br>

        <div class="box">
            <h5 id="billOfMaterials" style="margin-bottom: 1rem;">Bill of materials</h5>

            <table class="table table-bordered">
                <thead>
                    <th scope="col">S/N</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Item Description</th>
                    <th scope="col">Approx Cost</th>
                </thead>

                <tbody>
                    <tr>
                        <td>1</td>
                        <td>1</td>
                        <td>Raspberry Pi Pico (USB - C)</td>
                        <td>$10</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>20</td>
                        <td>1N4148 (Diodes)</td>
                        <td>$2.34</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>1</td>
                        <td>USB A - C</td>
                        <td>$2</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>12</td>
                        <td>Outemu Brown mechanical switches</td>
                        <td>$0</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>1</td>
                        <td>Rotary Encoder (EC11)</td>
                        <td>$2.51/5 pieces</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>1</td>
                        <td>Transparent Acrylic Sheet (A4 Size)</td>
                        <td>~$5</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>1</td>
                        <td>SSD1306 OLED Panel </td>
                        <td>$5.10</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <br>

        <div class="box" style="padding: 1rem">
            <h5 id="ideation">Ideation</h5>

            <p>My project idea was to make a mechanical keypad for macros and shortcuts to connect to my computer. It
                would also come with a rotary encoder to enable volume control and switching the layers and an OLED
                screen on the top half to show visual feedback to the user. </p>

            <br>

            <h5 id="3dModeling">3D Modeling</h5>
            <p>In order to have time to check for mistakes and reprint. I opted to go for a more box-like casing. This
                makes it very easy for the laser-cut plate to be mounted within the 3D printed frame.</p>
            <iframe
                src="https://ichat2665.autodesk360.com/shares/public/SH9285eQTcf875d3c5394ad02f04b5fbec48?mode=embed"
                width="100%" height="500" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"
                frameborder="0"></iframe>

            <br>

            <h5 id="3dPrint">3D Printing</h5>
            <h6>Printer Settings</h6>
            <ul>
                <li>Machine: Ultimaker 2+</li>
                <li>Material: White PLA</li>
                <li>Layer Height: 0.25mm</li>
                <li>Infill Density and Pattern: 10% Grid</li>
                <li>Supports: Yes</li>
                <li>Build Plate Adhesion: Brim</li>
            </ul>

            <div class="row" style="width: 100%;">
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/Final Top Casing.jpg" alt="Final Top Casing"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>Final Top Casing</figcaption>
                    </figure>
                </div>
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/Final Bottom Casing.jpg" alt="Final Bottom Casing"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>Final Bottom Casing</figcaption>
                    </figure>
                </div>
                <div class="col-4"></div>
            </div>

            <br>

            <h5 id="laserCutting">Laser Cutting</h5>
            <ul>
                <li>Machine: Universal Laser VLS6.60 Laser Cutter</li>
                <li>Material Thickness and Type: 3mm Transparent Acrylic</li>
                <li>Cut Settings: Speed - 7%, Frequency - 600ppi, Power - 40%</li>
            </ul>

            <div class="row" style="width: 100%;">
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/laserCutSketch.png" alt="Laser Cut Plate Design"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>Laser Cut Plate Design</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/Final Switch Plate.jpg" alt="Final Switch Plate"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>Final Switch Plate</figcaption>
                    </figure>
                </div>
            </div>

            <br>

            <h5 id="electronics">Electronics</h5>
            <p>Pinout of Raspberry Pi Pico</p>
            <img src="/EP1000/assets/Final Project/piPicoPinout.jpg" alt="Pi Pico Pinout"
                style="width: 100%; max-width: 640px">

            <br>

            <p>As The Raspberry Pi Pico has pullups built into each of the pins, I did not have to solder additional
                resistors. As I chose to debounce digitally, my circuit would be simpler as I would not need to have a
                hardware debouncer</p>

            <p>Electronic Diagram of Final Project</p>
            <img src="/EP1000/assets/Final Project/electronicSketch.png" alt="Electronic Sketch"
                style="background-color: white; width: 100%; max-width: 640px;">

            <p>Unfortunately, some pictures showcasing the soldering were lost, and this were the 2 that were recovered.
                In hindsight, it would have been a better idea to split the wires to be 6-6 on each side or go with
                matrix wiring to reduce the number of wires connected to the Pi Pico.</p>

            <div class="row" style="width: 100%;">
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/Common Ground.jpg"
                            alt="Switches soldered to common ground" style="width: 80%; border-radius: 5px;">
                        <figcaption>Switches soldered to common ground</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/Final Solder.jpg" alt="Final Solder"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>Final Solder</figcaption>
                    </figure>
                </div>
            </div>

            <br>

            <h5 id="assembly">Assembly</h5>
            <div class="row">
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/screwRotaryEncoder.jpeg"
                            alt="Screw Rotary Encoder onto Switchplate" style="width: 80%; border-radius: 5px;">
                        <figcaption>1. Screw Rotary Encoder onto Switchplate</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/putKeycaps.jpeg" alt="Put on Keycaps"
                            style="width: 80%; border-radius: 5px;">
                        <figcaption>2. Put on Keycaps</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/slotInPiPico.jpeg"
                            alt="Slot In Switchplate into Top case" style="width: 80%; border-radius: 5px;">
                        <figcaption>3. Slot In Switchplate into Top case</figcaption>
                    </figure>
                </div>
            </div>

            <div class="row">
                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/closingCaseTogether.jpeg"
                            alt="Snap Top and Bottom Case Together" style="width: 80%; border-radius: 5px;">
                        <figcaption>4. Snap Top and Bottom Case Together</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/screwingTopAndBottomCase.jpeg"
                            alt="Screwing Top and Bottom Case" style="width: 80%; border-radius: 5px;">
                        <figcaption>5. Screwing Top and Bottom Case</figcaption>
                    </figure>
                </div>

                <div class="col-4">
                    <figure>
                        <img src="/EP1000/assets/Final Project/glueingDisplayToSwitchplate.jpeg"
                            alt="Glue Display to Switchplate" style="width: 80%; border-radius: 5px;">
                        <figcaption>6. Glue Display to Switchplate</figcaption>
                    </figure>
                </div>
            </div>

            <br>

            <h5 id="code">Code</h5>
            <div class="row">
                <div class="col">
                    <img src="/EP1000/assets/Final Project/initializeDisplay.png" alt="Initialize Display"
                        class="img-fluid" style="width: 100%">
                </div>

                <div class="col">
                    <br>

                    <p>This is the code used to initialize the display.</p>

                    <p>I first initialize the I2C ports on the address 0x3C (found through a I2C port scanner), then
                        initialize an instance of the ssd1306 display using the adafruit library and input the correct
                        width and height values of the display.</p>

                    <p>I then created a display group and set a white header at the top of the screen in preparation for
                        the title text to be displayed.</p>

                    <p>The most difficult part about this initialization was honestly the screen groups. Documentation
                        was honestly just scarce and I was really forced to figure out how to operate the display by
                        trial and error.</p>
                </div>
            </div>

            <div class="row">
                <div class="col">

                    <br>

                    <p>This is the code used to intialized all the mechanical switches and rotary encoder. For the sake of code efficiency and cleanliness, I decided to put all the pins in an array and run a loop to configure the pins to INPUT and PULLUP. The switches are also passed through a function which attaches them to software debouncers throuhg the use of the Adafruit Debouncer library.</p>

                    <p>The encoder switch is also initialized in the same way as the 12 mechanical switches and the encoder itself is initialized using the in-built rotaryio library.</p>
                </div>

                <div class="col">
                    <img src="/EP1000/assets/Final Project/initializeSwitchesAndRotaryEncoder.png"
                        alt="Initialize switches and rotary encoder" class="img-fluid">
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <img src="/EP1000/assets/Final Project/updateSwitches.png" alt="Code to update switches and rotary encoder position" class="img-fluid">
                </div>

                <div class="col">
                    
                    <br>

                    <p>The code for the macropad is complex and long. It's a lot to take in so let's break it into several parts</p>

                    <p>Here we see the start of the main loop "while True:", which indicates that the code within the loop should be ran continously as long as the Pi Pico is powered on. We then update the states of the 13 switches using the Adafruit Debouncing library mentioned above.</p>

                    <p>We then refresh the variable noting the encoder's position with the current value of the encoder position.</p>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    
                    <br>

                    <p>The code segment here shows what happens when the macropad is in the standard macropad mode (default). Looking at "screen.append" we can see that the code first fills the display with the neccessary helper text. Afterwards, it was just a matter of detecting which key was the one that was pressed and executing the action associated with that key.</p>
                    
                </div>

                <div class="col">
                    <img src="/EP1000/assets/Final Project/functionMode.png" alt="Code that runs within the function mode" class="img-fluid">
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <img src="/EP1000/assets/Final Project/updateRotaryEncoder.png" alt="Code that runs within the function mode" class="img-fluid">
                </div>

                <div class="col">
                    
                    <br>

                    <p>The code segment here controls what happens when the rotary encoder is pressed/ rotated. As the use of the rotary switch is consistent across all modes, as long as the switch has been pressed, the macropad would be switched into the mode select mode. For the encoder rotation though, it passes through another if statement to check what it should do. </p>
                </div>
            </div>

        </div>

        <div class="box">
            <h5 id="showcase">Showcase</h5>

            <iframe width="560" height="315" src="https://www.youtube.com/embed/f-ffZ_Pm6BM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

            <br>

            <img class="img-fluid" src="/EP1000/assets/Final Project/projectSlide.png" alt="Project Slide" style="width: 50%;">
        </div>

        <div class="box">
            <h5 id="resources">Resources (Download files here)</h5>

            <ul>
                <li><a href="/EP1000/assets/Final Project/Files/Final Project.f3d">3D Model (Fusion 360 File)</a></li>
                <li><a href="/EP1000/assets/Final Project/Files/plate.dxf">Laser Cut Plate (DXF File)</a></li>
                <li><a href="/EP1000/assets/Final Project/Files/code.py">Macro Pad Code (Python File)</a></li>
            </ul>
        </div>

        <div class="box">
            <h5 id="references">References</h5>

            <ul>
                <li><a href="https://learn.adafruit.com/adafruit-macropad-rp2040/overview">Production-ready macro
                        pad by
                        Adafruit</a></li>
                <li><a href="https://matt3o.com/hand-wiring-a-custom-keyboard/">Matrix Wiring Guide</a></li>
                <li><a href="https://www.hackster.io/1NextPCB/how-to-build-a-pico-macro-pad-3638e6">How to build a
                        macro
                        pad with Raspberry Pi Pico</a></li>
                <li><a href="https://learn.adafruit.com/rotary-encoder/circuitpython">Rotary Encoder in
                        CircuitPython</a></li>
            </ul>
        </div>
    </div>

    <div id="footer"></div>
</body>

</html>